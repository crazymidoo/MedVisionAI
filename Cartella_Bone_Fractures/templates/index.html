<!DOCTYPE html>
<html>
<head>
    <title>Fracture Detection</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="{{ url_for('static', filename='js/preview.js') }}" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/IntenseImages/1.0.0/Intense.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom@9.4.0/dist/panzoom.min.js" defer></script>
</head>
<body>
    <h1>Upload X-Ray Image for Fracture Detection</h1>
    <form method="POST" enctype="multipart/form-data">
        <div id="drop-zone">
            <p>Trascina qui un'immagine oppure</p>
            <input type="file" id="file-input" name="file" accept="image/*" required>
        </div>
        <button type="submit">Upload & Analyze</button>
    </form>

    <div id="preview-container"></div>

    {% if original_image and result_image %}
        <h2>Image Comparison:</h2>
        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
            <div>
                <h3>Original</h3>
                <img 
                    src="{{ url_for('send_upload', filename=original_image) }}" 
                    class="intense" 
                    data-intense 
                    alt="Original X-Ray">
            </div>
            <div>
                <h3>Result</h3>
                <div id="result-container">
                    <img src="{{ url_for('send_result', filename=result_image) }}" id="result-image" alt="Result Image">
                </div>
                {% if accuracy is not none %}
                    <p><strong>Model Accuracy:</strong> {{ accuracy | round(1) }}%</p>
                {% else %}
                    <p>Accuracy not available.</p>
                {% endif %}
                <button id="download-pdf">Download PDF</button>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
            </div>
        </div>
    {% endif %}
</body>
</html>
